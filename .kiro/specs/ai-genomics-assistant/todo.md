## âœ… å·²å®Œæˆï¼šæ•°æ®åˆ†ç¦»æ¶æ„é‡æ„

### **é—®é¢˜æè¿°**

"æ¨¡å‹è®¾ç½®" (Model Settings) è¿™éƒ¨åˆ†ä¿¡æ¯å±äºåº”ç”¨çš„å…ƒæ•°æ®ï¼ˆmetadataï¼‰æˆ–é…ç½®ä¿¡æ¯ï¼Œ**ç†è®ºä¸Šä¸åº”è¯¥ä½œä¸ºå¯¹è¯å†…å®¹çš„ä¸€éƒ¨åˆ†å‘é€ç»™å¤§è¯­è¨€æ¨¡å‹**ã€‚

å°†è¿™éƒ¨åˆ†ä¿¡æ¯å‘é€ç»™æ¨¡å‹ä¼šå¸¦æ¥å‡ ä¸ªé—®é¢˜ï¼š

1.  **å¢åŠ å¹²æ‰°**ï¼šæ¨¡å‹å¯èƒ½ä¼šå°† "Qwen/Qwen3-VL-8B-Instruct" è¿™æ ·çš„æŠ€æœ¯æ ‡è¯†è¯¯è§£ä¸ºç”¨æˆ·è¾“å…¥çš„ä¸€éƒ¨åˆ†ï¼Œä»è€Œå½±å“å®ƒå¯¹ç”¨æˆ·çœŸå®æ„å›¾çš„ç†è§£ã€‚
2.  **æµªè´¹Token**ï¼šæ¯æ¬¡è¯·æ±‚éƒ½é™„å¸¦è¿™äº›æ— å…³ä¿¡æ¯ï¼Œä¼šä¸å¿…è¦åœ°æ¶ˆè€—ä¸Šä¸‹æ–‡çª—å£çš„é•¿åº¦å’Œè®¡ç®—èµ„æºï¼Œå°¤å…¶æ˜¯åœ¨é•¿å¯¹è¯ä¸­ã€‚
3.  **æ½œåœ¨çš„å®‰å…¨é£é™©**ï¼šæš´éœ²å†…éƒ¨çš„æŠ€æœ¯æ ˆç»†èŠ‚ï¼Œè™½ç„¶åœ¨è¿™ä¸ªä¾‹å­ä¸­é£é™©å¾ˆå°ï¼Œä½†é€šå¸¸è¢«è®¤ä¸ºæ˜¯ä¸å¥½çš„å®è·µã€‚

### **âœ… å·²å®æ–½çš„è§£å†³æ–¹æ¡ˆ**

æ ¸å¿ƒæ€æƒ³æ˜¯**å°†UIå±•ç¤ºçš„é…ç½®æ•°æ®ä¸å‘é€ç»™æ¨¡å‹çš„å¯¹è¯æ•°æ®è¿›è¡Œåˆ†ç¦»**ã€‚

#### **âœ… å®Œæˆï¼šåˆ†ç¦»æ•°æ®ç»“æ„**

**å®æ–½å†…å®¹ï¼š**

1. âœ… å®šä¹‰äº† `AppConfig` æ¥å£ï¼ŒåŒ…å« `modelName` ç­‰é…ç½®å±æ€§
2. âœ… å®šä¹‰äº† `ChatState` æ¥å£ï¼Œä»…åŒ…å« `messages` æ•°ç»„
3. âœ… æ¨¡å‹è®¾ç½®ç»„ä»¶ç›´æ¥ä» `appConfig` çŠ¶æ€è¯»å–æ•°æ®
4. âœ… èŠå¤©å†å²ç»„ä»¶åªä½¿ç”¨ `chatState.messages`

**ä»£ç å®ç°ï¼š**

```typescript
// åº”ç”¨é…ç½®æ¥å£ - ç”¨äºUIæ˜¾ç¤ºå’Œè¿æ¥é…ç½®
interface AppConfig {
  apiBaseUrl: string;
  apiKey: string;
  modelName: string;
}

// èŠå¤©çŠ¶æ€æ¥å£ - ä»…åŒ…å«å¯¹è¯å†å²
interface ChatState {
  messages: Message[];
}
```

#### **âœ… å®Œæˆï¼šæ„å»ºå¹²å‡€çš„APIè¯·æ±‚ä½“**

**å®æ–½å†…å®¹ï¼š**

1. âœ… ä¿®æ”¹äº† `websocketService.sendMessage` æ–¹æ³•
2. âœ… APIè¯·æ±‚ä½“åªåŒ…å«çº¯ç²¹çš„å¯¹è¯å†å²
3. âœ… é…ç½®ä¿¡æ¯ä¸å¯¹è¯å†…å®¹å®Œå…¨åˆ†ç¦»
4. âœ… å®ç°äº†æ­£ç¡®çš„æ¶ˆæ¯æ ¼å¼è½¬æ¢

**ä»£ç å®ç°ï¼š**

```typescript
// æ„å»ºå¹²å‡€çš„å¯¹è¯å†å² - åªåŒ…å«ç”¨æˆ·å’ŒåŠ©æ‰‹çš„å¯¹è¯å†…å®¹
const messages = chatHistory.map((msg) => ({
  role: msg.sender === "user" ? ("user" as const) : ("assistant" as const),
  content: msg.content,
}));

const message: WebSocketMessage = {
  query,
  messages, // çº¯ç²¹çš„å¯¹è¯å†å²ï¼Œä¸åŒ…å«é…ç½®ä¿¡æ¯
  ai_model_config: {
    apiBaseUrl: modelConfig.apiBaseUrl,
    apiKey: modelConfig.apiKey,
    modelName: modelConfig.modelName,
  },
};
```

### **ğŸ¯ ä¿®å¤æ•ˆæœ**

1. **âœ… æ¶ˆé™¤å¹²æ‰°**ï¼šæ¨¡å‹åç§°ç­‰æŠ€æœ¯æ ‡è¯†ä¸å†ä½œä¸ºå¯¹è¯å†…å®¹å‘é€ç»™LLM
2. **âœ… èŠ‚çœToken**ï¼šå‡å°‘äº†ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡æ¶ˆè€—
3. **âœ… æé«˜å®‰å…¨æ€§**ï¼šé…ç½®ä¿¡æ¯ä¸å¯¹è¯å†…å®¹å®Œå…¨åˆ†ç¦»
4. **âœ… æ”¹å–„æ¶æ„**ï¼šæ¸…æ™°çš„æ•°æ®æµå’ŒèŒè´£åˆ†ç¦»

### **ğŸ“‹ åç»­ä»»åŠ¡**

ç›®å‰æ•°æ®åˆ†ç¦»æ¶æ„å·²å®Œæˆï¼Œå¯ä»¥ç»§ç»­è¿›è¡Œå…¶ä»–åŠŸèƒ½å¼€å‘ã€‚

---

## ğŸ“ å¼€å‘æ—¥å¿—

**2024å¹´ä¿®å¤è®°å½•ï¼š**

- âœ… é‡æ„äº† `ChatInterface` ç»„ä»¶çš„çŠ¶æ€ç®¡ç†
- âœ… åˆ†ç¦»äº† `appConfig` å’Œ `chatState`
- âœ… ä¿®æ”¹äº† `websocketService.sendMessage` æ–¹æ³•
- âœ… å®ç°äº†å¹²å‡€çš„APIè¯·æ±‚ä½“ç»“æ„
- âœ… åˆ›å»ºäº† `ThinkingIndicator` ç»„ä»¶æ›¿ä»£ `LoadingIndicator`
- âœ… å®Œæˆäº†UIç»„ä»¶çš„ä¼˜åŒ–å’Œé›†æˆ
